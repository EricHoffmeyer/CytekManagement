---
title: "Cytek Management"
#output: html_notebook
---

# Load Libraries

```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
library(chron)
```

# Read in data

Read in csv files for galender and user/lab key

```{r}
cal_data <- read.csv('cytek_google_calendar.csv')
lab_key <- read.csv('lab_key.csv')
```

# Data wrangling

First I need to tidy this data by separating the date into individual columns.

add :00 to times
convert times into new column
create use time column
remove NA values
 

```{r}
# Add :00 to all times for conversion
cal_data$start <- paste(cal_data$start, ':00')
cal_data$end <- paste(cal_data$end, ':00')

cal_data <- cal_data |>
  separate(date, into = c('month', 'day', 'year'), sep = '/' ) |>
  mutate(time_start = chron(times. = start),
         time_end = chron(times. = end),
         use_time = time_end - time_start) |>
  na.omit() 
```


Since the `name` column contains values entered by all the users, it is a mix of upper and lower case as well


# In progess code


```{r temp variables}
temp <- data.frame(name = unique(cal_data$name)) # make a new df of unique name values


```

```{r}
#### This can work by explicit listing all names. Could I make a function to do iterate through this?
temp_2 <- temp |>
  mutate(clean_names = ifelse(grepl('ri', name, ignore.case = T), 'Ritz', name))
```






```{r}
temp_2 <- data.frame(var1 = unique(temp_2$clean_names)) # test temp_2 to see in unique # dropped
```



# Save below

```{r}
#### THIS WORKS!!! 
temp_2 <- temp |>
  mutate(clean_names = ifelse(grepl('ri', name, ignore.case = T), 'Ritz', name))
```

# Function set up testing

I think I can use a function to iterate through the names rather than list them one by one. Below are code chunk notes for that

```{r make name_df}
name_df <- data.frame(pattern = c('ri', 'we'),
                      cleaned = c('Ritz', 'Wenjuan'))
```


```{r function set up}
name.cleaner <- function(x, y, z) {
  for (i in x) {
    mutate(z, clean_names = ifelse(grepl(x, y, ignore.case = T), y, name))
  }
}
```


